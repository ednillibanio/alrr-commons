<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:al="http://xmlns.jcp.org/jsf/composite/componentes/core"
	xmlns:o="http://omnifaces.org/ui"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:ph="http://xmlns.jcp.org/jsf/passthrough" lang="pt-br">

<p:dialog id="dlg-feriado" widgetVar="dlg-feriado" showEffect="clip"
	hideEffect="clip" closeOnEscape="true" showHeader="false"
	responsive="true" modal="true" resizable="false" closable="false"
	appendTo="@(body)" styleClass="ui-fluid ui-md-8 ui-lg-8 nopad"
	fitViewport="true">


	<o:form id="frm-feriado">
	
		<!-- Exibe mensagens de erro -->
		<p:tooltip />	
		<p:growl id="msgs-dialog" />
		
		
		<p:panel header="Cadastro de Feriado">


			<p:panelGrid id="grid-feriado" columns="1" cellpadding="10"
				styleClass="ui-panelgrid-blank ui-fluid" layout="grid">

				<!--   C A M P O:   T I P O   F E R I A D O   -->
				<al:campo value="Tipo" for="tipo">
					<p:selectOneButton id="tipo"
						converter="omnifaces.GenericEnumConverter"
						value="#{feriadoController.entity.tipo}" required="true"
						label="Tipo">
						<f:selectItems value="#{commonsEnumFactory.tiposFeriados}"
							var="tipo" itemValue="#{tipo}" itemLabel="#{tipo.label}" />
						<p:ajax event="change" update="@form" process="@this" />
					</p:selectOneButton>
				</al:campo>


				<!--   C A M P O:   NO M E   D O   F E R I A D O   -->
				<al:campo value="Nome" for="nome">
					<p:inputText id="nome" required="true"
						value="#{feriadoController.entity.nome}" label="Nome">
						<p:watermark value="Nome do Feriado" for="nome" />
					</p:inputText>
				</al:campo>


				<!--   C A M P O:   D I A   -->
				<al:campo value="Dia" for="dia">
					<p:inputText id="dia" required="true"
						value="#{feriadoController.entity.dia}" type="number">
						<!-- <f:validator validatorId="diaValidatorClient" /> -->
					</p:inputText>
				</al:campo>

				<!--   C A M P O:   M Ê S   -->
				<al:campo value="Mês" for="mes">
					<o:importConstants type="br.leg.rr.al.core.domain.Mes" />
					<p:selectOneMenu id="mes" label="Mês"
						value="#{feriadoController.entity.mes}" required="true">
						<f:selectItem itemLabel="[Selecione]" noSelectionOption="true" />
						<f:selectItems value="#{commonsEnumFactory.meses}" var="mes"
							itemValue="#{mes}" itemLabel="#{mes.label}" />
					</p:selectOneMenu>
				</al:campo>


				<!-- CASO TIPOFERIADO = MUNICIPAL -->
				<h:panelGroup id="tipo-num"
					rendered="#{feriadoController.entity.tipo eq 'MUNICIPAL'}">

					<al:campo for="locmun" value="Município">

						<div class="ui-inputgroup">
							<p:autoComplete id="locmun" label="Município"
								value="#{feriadoController.entity.localidade}" required="true"
								emptyMessage="Nenhum município encontrado"
								completeMethod="#{localidadeCompleteController.completeByNome}"
								var="loc" itemLabel="#{loc.nome.concat(' - ').concat(loc.uf)}"
								itemValue="#{loc}" converter="#{entityConverter}"
								forceSelection="true" minQueryLength="3" maxResults="8">
								<p:column>
								#{loc.nome} - #{loc.uf}
							</p:column>
							</p:autoComplete>
							<p:commandButton id="btn-add-localidade"
								icon="fa fa-fw fa-file-text-o" title="Nova Localidade"
								process="@this" update="dlg-localidade"
								action="#{localidadeController.novo()}" />

						</div>

					</al:campo>

				</h:panelGroup>

				<!-- CASO TIPOFERIADO == ESTADUAL -->
				<h:panelGroup id="tipo-est"
					rendered="#{feriadoController.entity.tipo eq 'ESTADUAL'}">
					<al:campo value="Uf:" for="locuf">
						<p:selectOneMenu id="locuf" label="Uf"
							value="#{feriadoController.entity.uf}" required="true">
							<f:selectItem itemLabel="[Selecione]" noSelectionOption="true" />
							<f:selectItems value="#{commonsEnumFactory.ufs}" var="uf"
								itemValue="#{uf}" itemLabel="#{uf.label}" />
							<!-- 				<o:validateBean
								validationGroups="br.kmdr.commons.entity.feriado.constraints.FeriadoEstadual" />
			 -->
						</p:selectOneMenu>
					</al:campo>
				</h:panelGroup>
			</p:panelGrid>


			<!--   R O D A P É   D O   D I A L O G   -->
			<ui:decorate template="/componentes/core/dialog-rodape-botoes.xhtml">
				<!-- <ui:param name="fecharOncomplete" value="PF('dlg-feriado').hide()" />
				<ui:param name="controller" value="#{feriadoController}" />
				<ui:param name="salvarAction" value="salvar" /> -->


				<!--   B O T Ã O   F E C H A R   -->
				<ui:define name="btn-esquerda">
					<al:botao-fechar id="btnfechar"
						oncomplete="PF('dlg-feriado').hide()" />
				</ui:define>


				<!--   B O T Ã O   S A L V A R   -->
				<ui:define name="btn-direita">
					<al:botao-salvar id="btnsalvar"
						action="#{feriadoController.salvar()}" validateClient="true"
						update="frm-feriado frm-feriado:msgs-dialog" process="frm-feriado" />
				</ui:define>


			</ui:decorate>

		</p:panel>
	</o:form>

</p:dialog>
</html>
